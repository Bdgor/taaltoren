<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>TaalToren Puzzle</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
</head>
<body>

  <div id="global-rating-corner"></div>

  <!-- üîπ –†–û–ó–î–Ü–õ –†–ï–Ñ–°–¢–†–ê–¶–Ü–á -->
  <div id="register-section" style="margin-top: 40px;">
    <h2>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h2>
    <form id="registerForm">
      <input type="text" name="username" placeholder="–Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞" required>
      <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
      <input type="email" name="email" placeholder="Email" required>
      <button type="submit">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
    </form>
    <div id="registerMessage" style="margin-top:10px; font-weight: bold;"></div>
  </div>

  <div id="username-section" style="margin-top: 50px;">
    <h2>–í–≤–µ–¥—ñ—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –ª–æ–≥—ñ–Ω</h2>
    <input type="text" id="username-input" placeholder="–í–∞—à –ª–æ–≥—ñ–Ω">
    <button onclick="submitName()">–ü–æ—á–∞—Ç–∏</button>
  </div>

  <div id="level-selection" style="display: none;">
    <h2>–í–∏–±–µ—Ä—ñ—Ç—å —Ä—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ</h2>
    <button onclick="selectLevel('A0')">A0 (üî∞ –ü–æ—á–∞—Ç–∫–æ–≤–∏–π)</button>
    <button onclick="selectLevel('A1')">A1 (‚öôÔ∏è –ë–∞–∑–æ–≤–∏–π)</button>
    <button onclick="selectLevel('A2')">A2 (üî• –í–∏—â–∏–π)</button>
  </div>

  <div id="game" style="display: none;">
    <div id="puzzle-canvas"></div>
    <h3 id="level-display"></h3>
    <p><strong id="player-name"></strong></p>
    <p id="score-display"></p>
    <p id="storm-timer"></p>
    <div id="question"></div>
    <div id="options" class="option-row"></div>
    <div id="session-rating"></div>
  </div>

  <script>
    let socket = io("https://taaltoren.onrender.com");

    // üî∏ –û–±—Ä–æ–±–∫–∞ —Ñ–æ—Ä–º–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
    document.getElementById('registerForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const form = e.target;
      const data = {
        username: form.username.value,
        password: form.password.value,
        email: form.email.value
      };

      try {
        const res = await fetch('https://terminusapp.nl/register', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        const result = await res.json();
        document.getElementById('registerMessage').innerText = result.message || result.error;
        if (res.ok) form.reset();
      } catch (err) {
        document.getElementById('registerMessage').innerText = '–ü–æ–º–∏–ª–∫–∞ –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º.';
      }
    });

    // üî∏ –í–µ—Å—å —ñ–Ω—à–∏–π JS –∫–æ–¥ –≥—Ä–∏ ‚Äî —Ç–≤—ñ–π –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π ‚Äî –ó–ê–õ–ò–®–ê–Ñ–¢–¨–°–Ø –±–µ–∑ –∑–º—ñ–Ω –Ω–∏–∂—á–µ
  </script>

  <!-- –í—Å—Ç–∞–≤ —É–≤–µ—Å—å –∑–∞–ª–∏—à–æ–∫ —Å–≤–æ–≥–æ JS-–∫–æ–¥—É –Ω–∏–∂—á–µ (submitName, selectLevel, loadCSV —Ç–æ—â–æ) —è–∫ –±—É–ª–æ -->

</body>
</html>
